$(function (){
    $(".menu-toggler").on('click', function (){
        $('#overlayNavigation').toggleClass('active')
    })
})

// Script For Animated buttons
const ANIMATEDCLASSNAME = "animated";
const ELEMENTS = document.querySelectorAll(".themeBtn");
const ELEMENTS_SPAN = [];

ELEMENTS.forEach((element, index) => {
    let addAnimation = false;
    // Elements that contain the "FLASH" class, add a listener to remove
    // animation-class when the animation ends
    if (element.classList[1] == "FLASH") {
        element.addEventListener("animationend", (e) => {
            element.classList.remove(ANIMATEDCLASSNAME);
        });
        addAnimation = true;
    }

    // If The span element for this element does not exist in the array, add it.
    if (!ELEMENTS_SPAN[index]) ELEMENTS_SPAN[index] = element.querySelector("span");

    element.addEventListener("mouseover", (e) => {
        ELEMENTS_SPAN[index].style.left = e.pageX - element.offsetLeft + "px";
        ELEMENTS_SPAN[index].style.top = e.pageY - element.offsetTop + "px";

        // Add an animation-class to animate via CSS.
        if (addAnimation) element.classList.add(ANIMATEDCLASSNAME);
    });

    element.addEventListener("mouseout", (e) => {
        ELEMENTS_SPAN[index].style.left = e.pageX - element.offsetLeft + "px";
        ELEMENTS_SPAN[index].style.top = e.pageY - element.offsetTop + "px";
    });
});

// Script For Picture Uploader
$(document).ready(function () {
    var readURL = function (input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $(".profile-pic").attr("src", e.target.result);
            };
            reader.readAsDataURL(input.files[0]);
        }
    };
    $(".file-upload").on("change", function () {
        readURL(this);
    });
    $(".upload-button").on("click", function () {
        $(".file-upload").click();
    });
});

// Script For Full Screen Search
$(function () {
    $('a[href="#search"]').on("click", function (event) {
        event.preventDefault();
        $("#search").addClass("open");
        $('#search > form > input[type="search"]').focus();
    });

    $("#search, #search button.close").on("click keyup", function (event) {
        if (event.target == this || event.target.className == "close" || event.keyCode == 27) {
            $(this).removeClass("open");
        }
    });
});

// Input type tel formatter
var phone = document.querySelector("[type='tel']");

if (typeof phone == null) {
    phone.addEventListener("keyup", function (e) {
        if (event.key != "Backspace" && (phone.value.length === 3 || phone.value.length === 7)) {
            phone.value += "-";
        }
    });
}
